This sample requires ATL in order to run.  ATL is not available for 
Dev-C++. It is included with all commercial copies of Microsoft 
compilers. These compilers will be able to compile this sample, as is.

In order for users of either VS2005 Express or VS2008 express to
compile this program you will need to use the copy of ATL which 
ships with the latest "Platform Software Development Kit". Note that
the "Windows Software Development Kit" does NOT include ATL, but
VS2008 is compatible with the latest Platform SDK.

The latest Platform SDK can be downloaded from:
http://www.microsoft.com/msdownload/platformsdk/sdkupdate/

Once the Platform SDK is installed, users of VS2005 Express and VS2008 
Express will need to make the following changes:

 1) Add the include\atl path of Platform SDK to the set of
     directories used for include files.

 2) Modify atlwin.h
     Change SetChainEntry function at line 1725 and define
     "int i" at the first line of the function body.

 3) Modify atlbase.h
     Change AllocStdCallThunk and FreeStdCallThunk at line 287

     Make these changes:

		/* Comment these lines
		PVOID __stdcall __AllocStdCallThunk(VOID);
		VOID __stdcall __FreeStdCallThunk(PVOID);

		#define AllocStdCallThunk() __AllocStdCallThunk()
		#define FreeStdCallThunk(p) __FreeStdCallThunk(p)

		#pragma comment(lib, "atlthunk.lib")
		*/

     and add these 2 lines:
		#define AllocStdCallThunk() HeapAlloc(GetProcessHeap(), 0, sizeof(_stdcallthunk))
		#define FreeStdCallThunk(p) HeapFree(GetProcessHeap(), 0, p)


This information was published by Baryon Lee, in the CodeProject article
titled "Using WTL with Visual C++ 2005 Express Edition"
URL:  http://www.codeproject.com/wtl/WTLExpress.asp

This information was tested on Platform SDK version Windows Server 2003 R2
